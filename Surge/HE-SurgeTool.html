<!DOCTYPE html>
<!-- saved from url=(0046)http://live-healthy-elections.pantheonsite.io/ -->
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="js">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <link rel="shortlink" href="http://live-healthy-elections.pantheonsite.io/">
  <link rel="canonical" href="http://live-healthy-elections.pantheonsite.io/">
  <meta name="Generator" content="Drupal 8 (https://www.drupal.org)">
  <meta name="MobileOptimized" content="width">
  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="ie=edge, chrome=1" http-equiv="x-ua-compatible">
  <meta http-equiv="ImageToolbar" content="false">
  <link rel="shortcut icon" href="http://live-healthy-elections.pantheonsite.io/profiles/contrib/lightning/favicon.ico" type="image/vnd.microsoft.icon">
  <link rel="revision" href="http://live-healthy-elections.pantheonsite.io/home">

  <title>Stanford-MIT Healthy Elections Project</title>
  <link rel="stylesheet" media="all" href="./HE-SurgeTool_files/Pantheon_files/css_9m8-tA3IQf8ThlLQYTTZUyEweCvyR908Tg0XCbKYOfY.css">
  <link rel="stylesheet" media="all" href="./HE-SurgeTool_files/Pantheon_files/css_lQ4D06JPnsTCqcAl-sJ26Lghvgn02xjMJbRUamKZvBQ.css">
  <link rel="stylesheet" media="all" href="./HE-SurgeTool_files/Pantheon_files/css_lQ4D06JPnsTCqcAl-sJ26Lghvgn02xjMJbRUamKZvBQ.css">

  <script async="" src="./HE - Election Toolkit_files/analytics.js"></script>
  <script src="https://kit.fontawesome.com/6364ea47c0.js" crossorigin="anonymous"></script>
  

  <link href="./HE-SurgeTool_files/bootstrap.css" rel="stylesheet">
  <link href="./HE-SurgeTool_files/elections-styles/elections.css" rel="stylesheet">


  <!--[if lte IE 8]>
  <script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
  <![endif]-->

  <meta class="foundation-mq">
</head>
<body class="lang-en surge-tool">
<div class="alert alert-light alert-dismissible fade show" role="alert" style="position: fixed; width: 40%; z-index:9999; margin-left:30%">
  <a href="https://docs.google.com/forms/d/e/1FAIpQLSc1xWpI_ML7nu7UYpZiO6jC3yVRoX-dJ34qQZ9LZmT8WPnMIw/viewform?usp=pp_url&entry.439998991=Morning+Surge+Tool">Please click here to give feedback and help us improve.</a> 
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<a href="http://live-healthy-elections.pantheonsite.io/#main-content" class="visually-hidden focusable skip-link">
  Skip to main content
</a>
<div>
  <div class="off-canvas-content" data-off-canvas-content="">
    <header role="banner" aria-label="Site header">
      <div class="left large-2">
        <div id="site-name" class="site-title">
          <a href="/" title="Stanford-MIT Healthy Elections Project Home"><span class="site-sponsors">Stanford-MIT</span> <span class="site-name">Healthy Elections Project</span></a>
        </div>
      </div>
    </header>
  </div>
  <div class="row tool-title">
    <h1 align="left" class="section-title-noline large-12 medium-12 small-12">Morning Surge Queue Analysis</h1>
  </div>
  <!-- Inserted Colin's Code-->
  <div class="intro-container">
    <div class="intro-content row">
      <div class ="col-6 col-lg-6">
        Most polling places will face a surge of voters at some point during the day, often in the early morning. When many voters are lined up outside the polling place prior to the polls opening, it will take time before that line is expected to dissipate to zero. This tool helps understand what will happen during the time immediately after the polling place opens with a line already formed.
        <br>
        <br>
        <h3 align="left">Use This Tool To:</h3>
        <ul>
          <li>Determine when the morning surge will dissipate</li>
          <li>Determine how long lines will get during the surge</li>
        </ul>
        <hr>

      </div>
      
      <div class ="col-6 col-lg-6 text-center">
        <h3>Surge Dissipation Visualization</h3>
        <img src="./HE-SurgeTool_files/SurgeGraph.svg" class="img-fluid" alt="Responsive image" width="75%" >

      </div>

    </div>
  </div>
  <div class = "row">
    <div class="col-12 col-md-6">
      <div class="container">
        <h2 align="left" class="section-title-noline">Inputs</h2>
      </div>
      <div class="card">
        <div class="container">
          <br>
          <form name="linetypeform">
            Choose System Setup:
            <select class="bootstrap-select" style="width: 400px" id="setupselect" data-toggle="tooltip" data-placement = "top" title="Select the setup of your polling place">
              <option value="default" selected="selected">Check In > Voting > Scanners</option>
              <option value="noScanners" class="text-secondary">Check In > Voting</option>
              <option value="withHealth" class="text-secondary">Health Check > Check In > Voting > Scanners</option>
            </select>
          </form>
          <br>
          <h3>Polling Place Characteristics</h3>  
          <table id="precoviddata", class = "table table-bordered table-striped table-sm" width="50%">
            <thead>
              <tr>
                <td></td>
                <td colspan="2" style = "text-align: center"> Input Statistics </td>
                <td colspan="2" style = "text-align: center"> Calculated Statistics </td>
              </tr>
              <tr>
                <td>Task</td>
                <td>Number of Stations</td>
                <td>Average Time to Complete Task (min)</td>
                <td>Capacity (voters/hr)</td>    
                <td>Utilization (%)</td>               
              </tr>
            </thead>
            <tbody id = "precoviddatabody">
              <tr id = "preinput_0" class = "inputs" style="display: none">
                <td class="align-middle">Health Check</td>
                <td><input type = "numeric" class = "form-control input-sm stations_input" placeholder = "Enter Number"/></td>
                <td><input type = "numeric" class = "form-control input-sm time_input" placeholder = "Enter Number"/></td>
                <td id = "preoutput_0" class="align-middle"></td>
                <td id = "preutilization_0" class="align-middle"></td>
              </tr>
              <tr id = "preinput_1" class = "inputs">
                <td class="align-middle">Check In</td>
                <td><input type = "numeric" class = "form-control input-sm stations_input" placeholder = "Enter Number"/></td>
                <td><input type = "numeric" class = "form-control input-sm time_input" placeholder = "Enter Number"/></td>
                <td id = "preoutput_1" class="align-middle"></td>
                <td id = "preutilization_1" class="align-middle"></td>
              </tr>
              <tr id = "preinput_2" class = "inputs">
                <td class="align-middle">Voting</td>
                <td><input type = "numeric" class = "form-control input-sm stations_input" placeholder = "Enter Number"/></td>
                <td><input type = "numeric" class = "form-control input-sm time_input" placeholder = "Enter Number"/></td>
                <td id = "preoutput_2" class="align-middle"></td>
                <td id = "preutilization_2" class="align-middle"></td>
              </tr>
              <tr id = "preinput_3" class = "inputs">
                <td class="align-middle">Scanning</td>
                <td><input type = "numeric" class = "form-control input-sm stations_input" placeholder = "Enter Number"/></td>
                <td><input type = "numeric" class = "form-control input-sm time_input" placeholder = "Enter Number"/></td>
                <td id = "preoutput_3" class="align-middle"></td>
                <td id = "preutilization_3" class="align-middle"></td>
              </tr>
            </tbody>
          </table>
          <h3>Voter Arrival Characteristics</h3>
          <table id = "surgeinputtable" class = "table table-bordered table-striped table-sm">
            <thead>
              <tr>
                <td>Description</td>
                <td>Units</td>
                <td>Value</td>             
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Voter Arrival Rate</td>
                <td>Voters/hr</td>
                <td><input type = "numeric" class = "form-control input-sm input" placeholder = "Enter Number" id = "voterrate_2016"/></td>
              </tr>
              <tr>
                <td data-toggle="tooltip" data-placement = "top" title="Number of voters in line at start of day.">Length at Start</td>
                <td>Voters</td>
                <td><input type = "numeric" class = "form-control input-sm input" placeholder = "Enter Number" id = "queuelength_2016"/></td>
              </tr>
          </table>
        </div><!--Container-->
      </div><!--Card-->
      <button id="calcButton" class="btn btn-large btn-primary">Calculate</button>
    </div> <!-- Inputs Col -->
    <div class="col-12 col-md-6">
      <div class="container">
        <h2 align="left" class="section-title-noline">Outputs</h2>
      </div>
      <div class="card">
        <div class="container">
          <br>
          <h3>Surge Dynamics</h3>
          The output shows how long you can expect it to take for the line to return to zero. It also shows how likely it is that the line will grow to <b>at most</b> a certain length before it diminishes to zero.
          <table id = "surgetable" class = "table table-bordered table-striped table-sm">
          	<thead>
          		<tr>
          			<td>Description</td>
          			<td>Units</td>
          			<td>Value</td>
          		</tr>
          	</thead>
          	<tbody>
          		<tr>
          			<td data-toggle="tooltip" data-placement = "top" title="Expected time until no line">Duration of Surge</td>
          			<td>Hours</td>
          			<td id = "surge_duration_2016" class = "align-middle"></td>
          		</tr>
          		<tr>
          			<td data-toggle="tooltip" data-placement = "top" title="There is a 50% chance there will be a maximum of this many voters or fewer.">50% Chance</td>
          			<td>Voters</td>
          			<td id = "50percent_length_2016" class = "align-middle"></td>
          		</tr>
          		<tr>
          			<td data-toggle="tooltip" data-placement = "top" title="There is a 75% chance there will be a maximum of this many voters or fewer.">75% Chance</td>
          			<td>Voters</td>
          			<td id = "25percent_length_2016" class = "align-middle"></td>
          		</tr>
          		<tr>
          			<td data-toggle="tooltip" data-placement = "top" title="There is a 95% chance there will be a maximum of this many voters or fewer.">95% Chance</td>
          			<td>Voters</td>
          			<td id = "5percent_length_2016" class = "align-middle"></td>
          		</tr>
          	</tbody>
          </table>
        </div><!--Container-->
      </div><!--Card-->
    </div><!--Col-->
  </div><!--Row-->
  <div class="row" style="padding-top: 5px">
      <hr style="height:1px; border:none; color:#000; background-color:#000; width: 100%;">
    <div class="col-sm-10 col-10 col-md-10">
              <h3 align="left">Input Data Description</h3>
        <h4 align="left">Polling Place Characteristics</h4>
        <ol align="left">
            <li><b>System Setup:</b> Use the dropdown to change the polling place setup</li>
            <li><b>Number of stations:</b> The number of voters who can be served simultaneously at each step in the process</li>
            <li><b>Average Times:</b> The average time each voter spends at each station </li>
        </ol>
        <h4 align="left">Voter Behavior Characteristics</h4>
        <ol align="left">
            <li><b>Arrival Rate:</b> The average rate (voters/hour) that arrive at the polling place <b>after</b> the polls open</li>
            <li><b>Line Length at Start of Voting:</b> The length of the line prior to polls opening</li>
        </ol>
        <hr style="height:1px; border:none; color:#000; background-color:#000; width: 100%;">
      <h2 align="left" class="section-title-noline">Model Assumptions</h2>
      <p> This tool uses queueing theory to model the dissapation of a line given its downstream steps. This model is most easily thought of as studying the system in the early morning, immediately after opening the polls.  We assume that there is an empty system (i.e. nobody in the polling place) and a built up line (i.e. some number of people waiting outside) prior to opening the system, at which point the line is worked down at the average processing rate, and voters continue to arrive at the average arrival rate.</p>
      <p> The tool relies on a classic queuing model, known as an “M/M/k system.” For this model of a polling site, we assume that voters arrive randomly with a constant arrival rate, and join a single queue that is being served by a set of parallel stations or servers. In a polling site, we assume that we are modeling the bottleneck step in the process; this might be the check in stations, or the voting stations, or possibly the ballot scanning station or a health check.</p>
      <p> This tool assumes that immediately after opening, the line length decreases by the number of stations in the bottleneck. It then reports the line lengths that the system has a 50%, 25%, and 5% chance of reaching prior to reaching no line.</p>
      <p>This tool may be used to study a built up line in the middle of the day with a slight variation, see the instructional videos for more.</p>

      <h4 style="color:#122336">Developers: Stephen Graves and Colin McIntyre</h4>
    </div><!-- Col -->
  </div><!-- Row -->
  <hr style="height:1px; border:none; color:#000; background-color:#000; width: 100%;">
  <div class="row" style="padding-top: 5px">
    <h2>Video Tutorial</h2>
    <div class="col-1"></div>
    <div class="col-11">
    <iframe width="100%" class = "myIframe" src="https://www.youtube.com/embed/lgdVpZBngpU" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
  </div>


  <!--
    <a name="videos"></a>

      <div class="row">
      <br><br>
              <div class="col-md-12"><br>
          <h2 align="center" class="section-title-noline"><b>Instructional Videos</b></h2>
              </div>


        <div class="box center col-sm-12 col-12 col-md-12">
          <p align="center">Part 1</p>
              <div id="video1">
                      <iframe width="1140" height="645" src="./VTP - Election Toolkit_files/KgiYqhHN_gA.html" frameborder="2"></iframe>
                      <br><br>
                  </div>
          <a href="http://web.mit.edu/vtp/calc1.html#top" button="" class="btn btn-large smoothScroll">Back to Top</a><br><br>

                  <p align="center">Part 2</p>
                <div id="video2">
                      <iframe width="1140" height="645" src="./VTP - Election Toolkit_files/YkvWzzv_a8A.html" frameborder="1"></iframe>
              <br><br>
                  </div>
          <a href="http://web.mit.edu/vtp/calc1.html#top" button="" class="btn btn-large smoothScroll">Back to Top</a><br><br>


          <p align="center">Part 3</p>
            <div id="video3">
                      <iframe width="1140" height="645" src="./VTP - Election Toolkit_files/g7vk2DPwfpU.html" frameborder="1"></iframe>
                      <br><br>
                  </div>
          <a href="http://web.mit.edu/vtp/calc1.html#top" button="" class="btn btn-large smoothScroll">Back to Top</a><br><br>
              </div><-- /.box ->change comment
      </div><-- /.row ->change comment

  -->




  <!-- End Inserted Code From Colin-->
  <footer>
    <div class="row">
      <div id="footer-first" class="large-6 columns">
        <div>
          <section id="block-footercontactinfo" data-block-plugin-id="block_content:c0c24aa9-111b-480c-8a82-0bca655a3abf" class="block-footercontactinfo block      block-block-content block-block-contentc0c24aa9-111b-480c-8a82-0bca655a3abf">
            <div class="field-wrapper body field field-block-content--body field-name-body field-type-text-with-summary field-label-hidden">
              <div class="field-items">
                <div class="field-item">
                  <h4>Contact</h4>
                  <p><a href="mailto:mitelectionlab@mit.edu">mitelectionlab@mit.edu</a></p>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
      <div id="footer-last" class="large-6 columns">
        <div>
          <section id="block-footerlogos" data-block-plugin-id="block_content:e7c31c3a-5613-49d0-8380-8defac987eb5" class="block-footerlogos block block-block-content      block-block-contente7c31c3a-5613-49d0-8380-8defac987eb5">
            <div class="field-wrapper body field field-block-content--body field-name-body field-type-text-with-summary field-label-hidden">
              <div class="field-items">
                <div class="field-item"><p>&nbsp;</p>
                  <p><img alt="THE STANFORD-MIT HEALTHY ELECTIONS PROJECT" data-entity-type="file" data-entity-uuid="bdd12180-b4fd-46c9-8d33-75654a296598" height="37" src="      ./HE-SurgeTool_files/Pantheon_files/he-footer-logos_0.png" width="481" class="align-right"></p>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </footer>
  <div class="bottom-bar callout secondary">
    <div class="row">
      <div class="large-12 columns">
        © 2020 The Stanford-MIT Healthy Elections Project All rights reserved.
      </div>
    </div>
  </div>
</div>




<script type="text/javascript">
	$('.alert').alert()
</script>

<script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/25","currentPathIsAdmin":false,"isFront":true,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxTrustedUrl":{"\/search":true},"ajax":[],"user":{"uid":0,"permissionsHash":"1759c2da286d23900fc4bd7bd8c145360897889ca7b98125e8aeceb7bf065648"}}</script>
<script src="./HE-SurgeTool_files/Pantheon_files/js_BJeCZ0MbcFqMP0F1gYhkMYSB6z6TwiHfr-Skf3nT_zs.js"></script>

<script src="./HE-SurgeTool_files/jquery-3.5.1.min.js"></script>
    <script src="./HE-SurgeTool_files/popper.min.js"></script>
    <script src="./HE-SurgeTool_files/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" language="javascript"> 
      $('.myIframe').css('width', $(window).width()*0.6+'px');
      $('.myIframe').css('height', $(window).width()*0.6*0.56+'px');

      function scrollFunction() {
        document.getElementById('instructions').scrollIntoView();
        return true;
      }
    </script>

    <script type="text/javascript">
      //Function for updating the output table
      function writeOutputTable(stations_values, times_values){

        // Update Surge statistics
        var prethroughputs = updateThroughput();
        makeSurgeTable(stations_values, times_values, prethroughputs);


        // Activate the tooltips
        $(function () {
          $('[data-toggle="tooltip"]').tooltip();
        });


      }
    </script>
    <script type="text/javascript">
    	//Function to Calculate the Queue Length/surge
    	function makeSurgeTable(stations_values, times_values, prethroughputs){
    		//arrival rate
        	var prerate = document.getElementById('voterrate_2016').value;

        	// starting line length
        	var prelength = document.getElementById('queuelength_2016').value;

        	// 2016 Calculations
        	var minVal = indexOfMin(prethroughputs)[0];
        	var bottle_stations = stations_values[minVal];
        	var bottle_time = times_values[minVal];
        	var surge_time = calcSurgeTime(prelength, bottle_stations, bottle_time, prerate);
        	document.getElementById('surge_duration_2016').innerHTML = surge_time;

          if(bottle_stations >= prelength){
            document.getElementById('50percent_length_2016').innerHTML = "Line dissipates immediately";
            document.getElementById('25percent_length_2016').innerHTML = "Line dissipates immediately";
            document.getElementById('5percent_length_2016').innerHTML = "Line dissipates immediately";
          } else if(prerate < bottle_stations * (60/bottle_time)){
            var percentages = calcPercentages(numEntries=2000, percentages=[0.5,0.25,0.05], initial_line = prelength, bottle_stations, bottle_time, arrival_rate = prerate);
            document.getElementById('50percent_length_2016').innerHTML = percentages[0]+" or fewer";
            document.getElementById('25percent_length_2016').innerHTML = percentages[1]+" or fewer";
            document.getElementById('5percent_length_2016').innerHTML = percentages[2]+" or fewer";
          } else {
            document.getElementById('50percent_length_2016').innerHTML = "System is Unstable";
            document.getElementById('25percent_length_2016').innerHTML = "System is Unstable";
            document.getElementById('5percent_length_2016').innerHTML = "System is Unstable";
          }

    	}
    	function calcSurgeTime(initial_line, bottle_stations, bottle_time, arrival_rate){
    		if(bottle_stations >= initial_line){
          return("Line dissipates immediately")
        } else if(arrival_rate >= bottle_stations * (60/bottle_time)){
    			return("System is Unstable");
    		} else {
    			var total_exp_race = +arrival_rate + bottle_stations*(60/bottle_time);
    			var exp_race_win_probab = +arrival_rate/total_exp_race;
    			var surge_time = ((initial_line - bottle_stations)/(1-2*exp_race_win_probab))/(+arrival_rate + bottle_stations*(60/bottle_time));
    			return(+surge_time.toFixed(2));
    		}
    	}
    	function calcPercentages(numEntries, percentages, initial_line, bottle_stations, bottle_time, arrival_rate){
    		var probabs = [];
    		var thresholds = [];
    		var total_exp_race = +arrival_rate + bottle_stations*(60/bottle_time);
    		var exp_race_win_probab = +arrival_rate/total_exp_race;
    		var probab_ratio = (1-exp_race_win_probab)/exp_race_win_probab;
    		console.log(initial_line-bottle_stations);
    		for (i = 0; i < numEntries; i++){
    			var number = initial_line-bottle_stations+i;
    			var odds = (Math.pow(probab_ratio,(initial_line-bottle_stations))-1)/(Math.pow(probab_ratio,number)-1);
    			probabs.push(odds);
    		}
    		for (j = 0; j<percentages.length; j++){
    			i=0;
    			while (probabs[i]>percentages[j]){
    				i++;
    			}
    			thresholds.push(initial_line-bottle_stations+i-1);
    		}
    		return(thresholds);
    	}

    </script>
    <script type="text/javascript">
    // Dynamically update minimum value to calculate throughput of the system and identify the bottleneck
      function indexOfMin(arr) {
        console.log(arr);
          if (arr.length === 0) {
              return -1;
          }

          var min = Infinity;

          for (var i = 0; i < arr.length; i++) {
              if (arr[i] < min) {
                  minIndex = [i];
                  min = arr[i];
              } else if(arr[i]==min){
                  minIndex.push(i);
              }
          }
      
          return minIndex;
      }

      function updateThroughput(){
        var rows = document.getElementById("precoviddatabody").getElementsByClassName('inputs');
        var throughputs = [];
        //console.log(throughputs);
        var prerate = document.getElementById('voterrate_2016').value;
        // get data from the table
        for (let row of rows) {
          var sta = row.getElementsByClassName("stations_input")[0].value;
          var cyc = row.getElementsByClassName("time_input")[0].value;
          throughputs.push(+(sta*60/cyc).toFixed(2));
        }
        //console.log(throughputs);
        // check if all data has been entered
        /*let allNums = throughputs.every(function(e){
          return (!Number.isNaN(e) & e<Infinity);
        })*/
        var minVal = indexOfMin(throughputs);
        //console.log(minVal);
        var numRows = rows.length;
        //console.log(rows.length);
        var utils = [];
        // write throughputs
        for(i = 0; i<numRows; i++){
          utils[i]=(Math.min(prerate,throughputs[i])/throughputs[i]*100).toFixed(0);
          if(isNaN(throughputs[i])){
            throughputs[i] = "-";
            utils[i]="-";
          }
          //console.log(i);
          //console.log(i==minVal);
          //console.log(i.toString());
          if(minVal.includes(i)){
            // Report Bottleneck
            document.getElementById("preoutput_"+i.toString()).innerHTML = throughputs[i] + ' <button class="btn btn-warning btn-xs" \
                    data-toggle="tooltip" data-placement = "top" title="This is your bottleneck"  style="padding-left: 10px"><i class="fas fa-exclamation"></i></button>';
            document.getElementById("preutilization_"+i.toString()).innerHTML =utils[i];
          } else {
            // Report Not Bottleneck
            document.getElementById("preoutput_"+i.toString()).innerHTML = throughputs[i];
            document.getElementById("preutilization_"+i.toString()).innerHTML =utils[i];
          }
        }
        // Activate the tooltips
        $(function () {
          $('[data-toggle="tooltip"]').tooltip();
        });
        return(throughputs);
      }


      //function to update the pre-covid inputs
      //initialize inputs
      var numSteps = document.getElementById("precoviddatabody").getElementsByClassName('inputs').length;
      var stations_values = new Array(numSteps).fill(0);
      var times_values = new Array(numSteps).fill(0);
      function updateInputs() {
        var rows = document.getElementById("precoviddatabody").getElementsByClassName('inputs');
        for(i=0;i<rows.length; i++) {
          stations_values[i] = parseFloat(rows[i].getElementsByClassName("stations_input")[0].value);
          times_values[i] = parseFloat(rows[i].getElementsByClassName("time_input")[0].value);
        }
        //console.log(stations_values);
        //console.log(times_values);
      }

    </script>
    <script type="text/javascript">
      //function to find index
      function indexInParent(node) {
        var children = node.parentNode.childNodes;
        var num = 0;
        for (var i=0; i<children.length; i++) {
             if (children[i]==node) return num;
             if (children[i].nodeType==1) num++;
        }
        return -1;
      }

      

    </script>

    <script type="text/javascript">
      function setupSelection(selector){
        var choice = selector.options[selector.selectedIndex].value;
        if(choice == "noScanners"){
          document.getElementById("preinput_3").style.display = ("none");
          document.getElementById("preinput_3").getElementsByClassName("stations_input")[0].value = Infinity;
          document.getElementById("preinput_0").style.display = ("none");
          document.getElementById("preinput_0").getElementsByClassName("stations_input")[0].value = Infinity;
        } 
        if(choice == "withHealth"){
          document.getElementById("preinput_3").style.display = ("table-row");
          if(document.getElementById("preinput_3").getElementsByClassName("stations_input")[0].value == Infinity){
            document.getElementById("preinput_3").getElementsByClassName("stations_input")[0].value = 2;
          }
          document.getElementById("preinput_0").style.display = ("table-row");
          if(document.getElementById("preinput_0").getElementsByClassName("stations_input")[0].value == Infinity){
            document.getElementById("preinput_0").getElementsByClassName("stations_input")[0].value = 2;
          }
        }
        if(choice == "default"){
          document.getElementById("preinput_3").style.display = ("table-row");
          if(document.getElementById("preinput_3").getElementsByClassName("stations_input")[0].value == Infinity){
            document.getElementById("preinput_3").getElementsByClassName("stations_input")[0].value = 2;
          }
          document.getElementById("preinput_0").style.display = ("none");
          document.getElementById("preinput_0").getElementsByClassName("stations_input")[0].value = Infinity;
        }
        updateInputs();
        updateThroughput();
        writeOutputTable(stations_values, times_values);
      }
    </script>

    <script type="text/javascript">
      /*
      //initialize
      updateInputs();
      updateThroughput();
      writeOutputTable(stations_values, times_values);

      // add listeners for updates
      const input = document.getElementById("precoviddatabody").getElementsByTagName("input");
      for (let item of input) {
        item.addEventListener('blur', updateThroughput);
        item.addEventListener('blur', updateInputs);
        item.addEventListener('blur', function(){writeOutputTable(stations_values, times_values)},false);
      }


      // add listeners for updates
      var voterArrivalRate = document.getElementById("surgeinputtable").getElementsByClassName("input");
      for (let item of voterArrivalRate) {
        item.addEventListener('blur', function(){writeOutputTable(stations_values, times_values)},false);
      }
      */

      // add listeners for setup selections
      document.getElementById("setupselect").addEventListener('change', function(){setupSelection(document.getElementById("setupselect"))},false);


      function masterFun(){
        updateInputs();
        updateThroughput();
        writeOutputTable(stations_values, times_values);
      }


      document.getElementById("calcButton").addEventListener('click', masterFun);
    </script>



    <!--Tooltip Activation-->
    <script type="text/javascript">
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>



</body>
</html>